----------Main.m--------         the file to obtain the results for the three schemes (the proposed scheme, the benchmark with random energy beamforming, and the benchmark with equal time allocation) and plot Fig. 2 (a)
--BackThenForward.m--          the proposed algorithm (Algorithm 1 of this paper) used to find the optimal solution for the proposed scheme
------bisection1.m-------         the bisection method used to find the unique solution $z_i$ in Theorem 1 of this paper
---------fun1.m----------         the function to describe $f(z_i)$ in Theorem 1 of this paper.

Please run "Main.m" to obtain Fig.2 (a)